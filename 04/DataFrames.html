<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>DataFrames</title>
  <meta name="description" content="DataFrames">

  <link rel="canonical" href="https://ds1.datascience.uchicago.edu/04/DataFrames.html">
  <link rel="alternate" type="application/rss+xml" title="Data Science I" href="https://ds1.datascience.uchicago.edu/feed.xml">

  <meta property="og:url"         content="https://ds1.datascience.uchicago.edu/04/DataFrames.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="DataFrames" />
<meta property="og:description" content="DataFrames" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://ds1.datascience.uchicago.edu/04/DataFrames.html",
  "headline":
    "DataFrames",
  "datePublished":
    "2020-02-27T15:39:25-06:00",
  "dateModified":
    "2020-02-27T15:39:25-06:00",
  "description":
    "DataFrames",
  "author": {
    "@type": "Person",
    "name": "University of Chicago"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ds1.datascience.uchicago.edu",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://ds1.datascience.uchicago.edu",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC -->
  <script src="/assets/js/tocbot.min.js"  type="text/javascript"></script>
  <script>
var initToc = function () {
  tocbot.init({
    tocSelector: 'nav.onthispage',
    contentSelector: '.c-textbook__content',
    headingSelector: 'h2, h3',
    orderedList: false,
    collapseDepth: 6,
    listClass: 'toc__menu',
    activeListItemClass: "",  // Not using
    activeLinkClass: "", // Not using
  });
  tocbot.refresh();
}
initFunction(initToc);
</script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a id="copy-button-${id}" class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.c-textbook__content > div.highlighter-rouge > div.highlight > pre, div.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("copy-button" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>


  <!-- Hide cell code -->
  <script>
    /**
    Add buttons to hide code cells
    */


    var setCodeCellVisibility = function (inputField, kind) {
        // Update the image and class for hidden
        var id = inputField.getAttribute('data-id');
        var codeCell = document.querySelector(`#${id} div.highlight`);

        if (kind === "visible") {
            codeCell.classList.remove('hidden');
            inputField.checked = true;
        } else {
            codeCell.classList.add('hidden');
            inputField.checked = false;
        }
    }

    var toggleCodeCellVisibility = function (event) {
        // The label is clicked, and now we decide what to do based on the input field's clicked status
        if (event.target.tagName === "LABEL") {
            var inputField = event.target.previousElementSibling;
        } else {
            // It is the span inside the target
            var inputField = event.target.parentElement.previousElementSibling;
        }

        if (inputField.checked === true) {
            setCodeCellVisibility(inputField, "visible");
        } else {
            setCodeCellVisibility(inputField, "hidden");
        }
    }


    // Button constructor
    const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

    var addHideButton = function () {
        // If a hide button is already added, don't add another
        if (document.querySelector('div.hidecode input') !== null) {
            return;
        }

        // Find the input cells and add a hide button
        document.querySelectorAll('div.input_area').forEach(function (item, index) {
            if (!item.classList.contains("hidecode")) {
                // Skip the cell if it doesn't have a hidecode class
                return;
            }

            const id = codeCellId(index)
            item.setAttribute('id', id);
            // Insert the button just inside the end of the next div
            item.querySelector('div').insertAdjacentHTML('beforeend', hideCodeButton(id))

            // Set up the visibility toggle
            hideLink = document.querySelector(`#${id} div.highlight + input + label`);
            hideLink.addEventListener('click', toggleCodeCellVisibility)
        });
    }


    // Initialize the hide buttos
    var initHiddenCells = function () {
        // Add hide buttons to the cells
        addHideButton();

        // Toggle the code cells that should be hidden
        document.querySelectorAll('div.hidecode input').forEach(function (item) {
            setCodeCellVisibility(item, 'hidden');
            item.checked = true;
        })
    }

    initFunction(initHiddenCells);

</script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://ds1.datascience.uchicago.edu") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("https://datascience.uchicago.edu/s/jupyter", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="/"><img src="/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Data Science I</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/intro.html"
        >
          
          Introduction
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/search.html">Search</a></li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/01/what-is-data-science.html"
        >
          
            1.
          
          Demo: Data Science
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/01/1/intro.html"
                >
                  
                    1.1
                  
                  Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/01/2/why-data-science.html"
                >
                  
                    1.2
                  
                  Why Data Science?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/01/3/Plotting_the_Classics.html"
                >
                  
                    1.3
                  
                  Plotting the Classics
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/01/3/subsection/subsections.html"
                    >
                      
                        1.3.1
                        
                      
                      Subsection Demo 1
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/01/3/subsection/subsectiontwo.html"
                    >
                      
                        1.3.2
                        
                      
                      Subsection Demo 2
                    </a>
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/02/causality-and-experiments.html"
        >
          
            2.
          
          Demo: Causality and Experiments
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/02/1/observation-and-visualization-john-snow-and-the-broad-street-pump.html"
                >
                  
                    2.1
                  
                  John Snow and the Broad Street Pump
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/02/2/snow-s-grand-experiment.html"
                >
                  
                    2.2
                  
                  Snow’s “Grand Experiment”
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/02/3/establishing-causality.html"
                >
                  
                    2.3
                  
                  Establishing Causality
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/02/4/randomization.html"
                >
                  
                    2.4
                  
                  Randomization
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/02/5/endnote.html"
                >
                  
                    2.5
                  
                  Endnote
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/03/programming-in-python.html"
        >
          
            3.
          
          Programming in Python
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/1/Expressions.html"
                >
                  
                    3.1
                  
                  Expressions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/2/Names.html"
                >
                  
                    3.2
                  
                  Names
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/03/2/1/Growth.html"
                    >
                      
                        3.2.1
                        
                      
                      Example: Growth Rates
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/3/Types.html"
                >
                  
                    3.3
                  
                  Data Types
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/03/3/1/Numbers.html"
                    >
                      
                        3.3.1
                        
                      
                      Numbers
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/03/3/2/Strings.html"
                    >
                      
                        3.3.2
                        
                      
                      Strings
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/03/3/3/Sequences.html"
                    >
                      
                        3.3.3
                        
                      
                      Sequences
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/4/Comparison.html"
                >
                  
                    3.4
                  
                  Comparisons
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/5/Calls.html"
                >
                  
                    3.5
                  
                  Call Expressions
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/03/5/1/String_Methods.html"
                    >
                      
                        3.5.1
                        
                      
                      String Methods
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/03/6/Functions.html"
                >
                  
                    3.6
                  
                  Functions
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry c-sidebar__entry--active"
          href="/04/DataFrames.html"
        >
          
            4.
          
          DataFrames
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
      <aside class="sidebar__right">
          <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
          <nav class="onthispage">
          </nav>
      </aside>
      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">
<a href="/content/04/DataFrames.ipynb" download>
<button id="interact-button-download" class="interact-button">Download</button>
</a>










<a href="https://datascience.uchicago.edu/s/jupyter/hub/user-redirect/git-pull?repo=https://github.com/uchicagods/textbook-datascience-1&amp;branch=gh-pages&amp;subPath=content%2F04%2FDataFrames.ipynb&amp;app=notebook"><button class="interact-button" id="interact-button-jupyterhub"><img class="interact-button-logo" src="/assets/images/logo_jupyterhub.svg" alt="Interact" />Interact</button></a>



</div>


            <div class="c-textbook__content">
              <h1 id="dataframes">DataFrames</h1>

<p>The <code class="highlighter-rouge">DataFrame</code> is a type of data structure in Python which is widely-used in Data Science, and provided by the <a href="https://pandas.pydata.org/" rel="noopener" target="_blank"><code class="highlighter-rouge">pandas</code></a> data analysis and manipulation library.</p>

<p><code class="highlighter-rouge">DataFrames</code> are <em>collections</em> like <code class="highlighter-rouge">lists</code>. But, while <code class="highlighter-rouge">lists</code> <em>allow</em> you to collect elements which are themselves <code class="highlighter-rouge">lists</code>, <code class="highlighter-rouge">DataFrames</code> are built expressly for the purpose of manipulating such data easily and efficiently. This structure is “tabular” – like a spreadsheet – and also considered “two-dimensional.” Its dimensions are commonly:</p>

<dl>
  <dt><strong>a sequence of <em>columns</em></strong>:</dt>
  <dd>each column represents the values of a single <em>feature</em> of our data set</dd>
  <dt><strong>a sequence of <em>rows</em></strong>:</dt>
  <dd>each row represents the values of all of the features of a single <em>individual</em> element of our data</dd>
</dl>

<h2 id="construction">Construction</h2>

<p>We began to consider this sort of data in <a href="/03/3/3/Sequences.html#other-lists">Sequences</a>, with the distances of planets from our sun. Let’s expand on this example with the below data, adding the planets’ masses, densities and gravities.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'name'</span><span class="p">,</span>                <span class="c"># familiar name</span>
    <span class="s">'solar_distance_km_6'</span><span class="p">,</span> <span class="c"># distance from sun: 10**6 km</span>
    <span class="s">'mass_kg_24'</span><span class="p">,</span>          <span class="c"># absolute mass: 10**24 kg</span>
    <span class="s">'density_kg_m3'</span><span class="p">,</span>       <span class="c"># density: kg/m**3</span>
    <span class="s">'gravity_m_s2'</span><span class="p">,</span>        <span class="c"># gravity: m/s**2</span>
<span class="p">]</span>

<span class="n">planets_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s">'Mercury'</span><span class="p">,</span> <span class="mf">57.9</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">5427.0</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Venus'</span><span class="p">,</span> <span class="mf">108.2</span><span class="p">,</span> <span class="mf">4.87</span><span class="p">,</span> <span class="mf">5243.0</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Earth'</span><span class="p">,</span> <span class="mf">149.6</span><span class="p">,</span> <span class="mf">5.97</span><span class="p">,</span> <span class="mf">5514.0</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Mars'</span><span class="p">,</span> <span class="mf">227.9</span><span class="p">,</span> <span class="mf">0.642</span><span class="p">,</span> <span class="mf">3933.0</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Jupiter'</span><span class="p">,</span> <span class="mf">778.6</span><span class="p">,</span> <span class="mf">1898.0</span><span class="p">,</span> <span class="mf">1326.0</span><span class="p">,</span> <span class="mf">23.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Saturn'</span><span class="p">,</span> <span class="mf">1433.5</span><span class="p">,</span> <span class="mf">568.0</span><span class="p">,</span> <span class="mf">687.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Uranus'</span><span class="p">,</span> <span class="mf">2872.5</span><span class="p">,</span> <span class="mf">86.8</span><span class="p">,</span> <span class="mf">1271.0</span><span class="p">,</span> <span class="mf">8.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">'Neptune'</span><span class="p">,</span> <span class="mf">4495.1</span><span class="p">,</span> <span class="mf">102.0</span><span class="p">,</span> <span class="mf">1638.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">planets_data</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[['Mercury', 57.9, 0.33, 5427.0, 3.7],
 ['Venus', 108.2, 4.87, 5243.0, 8.9],
 ['Earth', 149.6, 5.97, 5514.0, 9.8],
 ['Mars', 227.9, 0.642, 3933.0, 3.7],
 ['Jupiter', 778.6, 1898.0, 1326.0, 23.1],
 ['Saturn', 1433.5, 568.0, 687.0, 9.0],
 ['Uranus', 2872.5, 86.8, 1271.0, 8.7],
 ['Neptune', 4495.1, 102.0, 1638.0, 11.0]]
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Now let’s construct a <code class="highlighter-rouge">DataFrame</code> for these data.</p>

<p>First, we’ll have to ensure that the <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html" target="_blank" rel="noopener">pandas library is installed</a>.</p>

<p>Then, we can tell Python to make <code class="highlighter-rouge">pandas</code> available to us using an <code class="highlighter-rouge">import</code> statement. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import pandas
</code></pre></div></div>

<p>Having done so, the <code class="highlighter-rouge">DataFrame</code> type would be available as: <code class="highlighter-rouge">pandas.DataFrame</code>.</p>

<p>That is, unlike with the built-in <code class="highlighter-rouge">list</code>, we would refer to it as “under” the name <code class="highlighter-rouge">pandas</code>, with a dot between the two names.</p>

<p>Or, we could import just <code class="highlighter-rouge">DataFrame</code>, such that it’s available as just <code class="highlighter-rouge">DataFrame</code>, without the rigmarole:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from pandas import DataFrame
</code></pre></div></div>

<p>However, we’ll be using <code class="highlighter-rouge">pandas</code> a lot! And not <em>just</em> <code class="highlighter-rouge">DataFrame</code>. Following a common convention, we’ll tell Python to assign the library module the name <code class="highlighter-rouge">pd</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">planets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">planets_data</span><span class="p">)</span>

<span class="n">planets</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Above, we’ve:</p>

<ul>
  <li>imported the <code class="highlighter-rouge">pandas</code> library under the name <code class="highlighter-rouge">pd</code></li>
  <li>constructed a new <code class="highlighter-rouge">DataFrame</code> from our list-of-list data</li>
  <li>assigned to the <code class="highlighter-rouge">DataFrame</code> the name <code class="highlighter-rouge">planets</code></li>
</ul>

<p>And this presentation of our data is already looking more like a spreadsheet.</p>

<p>However, there’s something odd about the above. We’re accustomed now to numbering elements of a sequence by their <em>offset</em> – 0, 1, 2, 3, … – and this works in this case for numbering our rows. But this isn’t a useful scheme for labeling our columns. We’ll make manipulation of this data easier, and avoid confusion about what these values represent, by defining useful column labels.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">planets_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">planets_features</span><span class="p">)</span>

<span class="n">planets</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>That’s better!</p>

<p>As we’ve seen with the <code class="highlighter-rouge">list</code>, (and the string), the <code class="highlighter-rouge">DataFrame</code> can be manipulated by functions and built-in operators. Moreover, these offer special-purpose functions which have been <em>bound</em> to their types – that is, <em>methods</em> – which are invoked with expressions of the form below:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name_of_dataframe.name_of_method(argument0, argument1, ..., keyword0=value0, ...)
</code></pre></div></div>

<p>And, similar to methods, there are <em>attributes</em> and <em>properties</em>. These are values which are similarly bound to the <code class="highlighter-rouge">DataFrame</code>, but which need not be called:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name_of_dataframe.name_of_property
</code></pre></div></div>

<p>Now we’re ready to explore the dimensions our data.</p>

<h2 id="features">Features</h2>

<p>We assigned the following column names:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">columns</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['name', 'solar_distance_km_6', 'mass_kg_24', 'density_kg_m3',
       'gravity_m_s2'],
      dtype='object')
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p><code class="highlighter-rouge">pandas</code> has constructed an <code class="highlighter-rouge">Index</code> for our columns. But we can get back our column list with the method <code class="highlighter-rouge">tolist()</code>:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['name', 'solar_distance_km_6', 'mass_kg_24', 'density_kg_m3', 'gravity_m_s2']
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>So let’s take a look at the first dimension of our data, the <em>features</em>, such as <code class="highlighter-rouge">name</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">name</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    Mercury
1      Venus
2      Earth
3       Mars
4    Jupiter
5     Saturn
6     Uranus
7    Neptune
Name: name, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Above, we’ve extracted from our data a one-dimensional sequence of the names of the planets in our solar system – (even though there was no such list in our initial input data <code class="highlighter-rouge">planets_data</code>).</p>

<p>This sequence is of another data type provided by <code class="highlighter-rouge">pandas</code>: the <code class="highlighter-rouge">Series</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span><span class="p">(</span><span class="n">planets</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandas.core.series.Series
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>We can do the same for the next column, representing the distances of these planets from the sun, in 10<sup>6</sup> km.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0      57.9
1     108.2
2     149.6
3     227.9
4     778.6
5    1433.5
6    2872.5
7    4495.1
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>And we can compute aggregates of this data, such as the average or <em>mean</em>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1265.4125000000001
</code></pre></div>      </div>

    </div>
  </div>
</div>

<h2 id="individuals">Individuals</h2>

<p>The second dimension of our data consists of its rows or <em>individuals</em>.</p>

<p>As with the columns, <code class="highlighter-rouge">pandas</code> has constructed an index for our rows. By default, this is the familiar <code class="highlighter-rouge">0, 1, 2, …</code>, and represented by the <code class="highlighter-rouge">RangeIndex</code> type.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">index</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RangeIndex(start=0, stop=8, step=1)
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>And, as with the <code class="highlighter-rouge">list</code>, we can use the built-in function <code class="highlighter-rouge">len</code> to see that there are eight planets.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">len</span><span class="p">(</span><span class="n">planets</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>We can also <em>slice</em> the <code class="highlighter-rouge">DataFrame</code>, for example to extract only its first three rows.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.33</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.87</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Above, our slice has constructed a new <code class="highlighter-rouge">DataFrame</code>, consisting of only the data for the first three planets.</p>

<p><strong>However</strong>: you <em>can’t</em> access <em>individual</em> rows or elements in the same manner as with a <code class="highlighter-rouge">list</code>:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    /opt/conda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
       2896             try:
    -&gt; 2897                 return self._engine.get_loc(key)
       2898             except KeyError:


    pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()


    pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    KeyError: 2

    
    During handling of the above exception, another exception occurred:


    KeyError                                  Traceback (most recent call last)

    &lt;ipython-input-13-e3d749a015ed&gt; in &lt;module&gt;
    ----&gt; 1 planets[2]
    

    /opt/conda/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
       2978             if self.columns.nlevels &gt; 1:
       2979                 return self._getitem_multilevel(key)
    -&gt; 2980             indexer = self.columns.get_loc(key)
       2981             if is_integer(indexer):
       2982                 indexer = [indexer]


    /opt/conda/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
       2897                 return self._engine.get_loc(key)
       2898             except KeyError:
    -&gt; 2899                 return self._engine.get_loc(self._maybe_cast_indexer(key))
       2900         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
       2901         if indexer.ndim &gt; 1 or indexer.size &gt; 1:


    pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()


    pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()


    KeyError: 2


</code></pre></div>      </div>
    </div>
  </div>
</div>

<p>After all, the <code class="highlighter-rouge">DataFrame</code> is a more complex structure than the <code class="highlighter-rouge">list</code> – the above reference to the offset <code class="highlighter-rouge">2</code> was treated as a reference to a column!</p>

<p>Indeed, this is an alternate syntax <em>for extracting columns</em>, and which is useful and necessary when columns are given complex names. (Complex names are any including characters which are part of Python’s syntax, and therefore invalid names of assignment, such as spaces, quotes, brackets, <em>etc.</em>)</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    Mercury
1      Venus
2      Earth
3       Mars
4    Jupiter
5     Saturn
6     Uranus
7    Neptune
Name: name, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Instead, <code class="highlighter-rouge">DataFrame</code> offers the properties <code class="highlighter-rouge">iloc</code> and <code class="highlighter-rouge">loc</code>, which may themselves be queried with a syntax similar to that of retrieving elements from a <code class="highlighter-rouge">list</code>.</p>

<p><code class="highlighter-rouge">iloc</code> is intended for <em>integer-location</em> based look-up of elements by their position in the index.</p>

<p>We can reproduce our slice explicitly using <code class="highlighter-rouge">iloc</code>:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.33</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.87</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>We can also do something new – construct a new <code class="highlighter-rouge">DataFrame</code> consisting of only the rows at the specified offsets.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.33</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.00</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Above, we’ve specified to our <code class="highlighter-rouge">iloc</code>-based look-up a <code class="highlighter-rouge">list</code> – <code class="highlighter-rouge">[0, 7]</code> – indicating that we are interested in selecting out the rows at those offsets.</p>

<p>Note that in the new <code class="highlighter-rouge">DataFrame</code>, the planets’ row index values have been preserved. This is highly useful – indeed, Neptune is still the same planet as it was before. But <code class="highlighter-rouge">iloc</code> is <strong>strictly</strong> intended for offsets, like in a <code class="highlighter-rouge">list</code>. If we were to repeat our selection of <code class="highlighter-rouge">[0, 7]</code> on the above, this would fail. Rather, the offset references for these two planets in the new <code class="highlighter-rouge">DataFrame</code> are now given by <code class="highlighter-rouge">[0, 1]</code>. According to <code class="highlighter-rouge">iloc</code> in this new <code class="highlighter-rouge">DataFrame</code>, Neptune will now be available at offset <code class="highlighter-rouge">1</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bookends</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>

<span class="n">bookends</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Neptune
solar_distance_km_6     4495.1
mass_kg_24                 102
density_kg_m3             1638
gravity_m_s2                11
Name: 7, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>In the next section, we will explore selection of elements by index value or label.</p>

<p>But now we can retrieve the features of another individual of our data set – Earth, the third planet from the sun.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earth</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">earth</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Earth
solar_distance_km_6    149.6
mass_kg_24              5.97
density_kg_m3           5514
gravity_m_s2             9.8
Name: 2, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>We can further extract from this just the Earth’s distance from the Sun.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earth</span><span class="o">.</span><span class="n">solar_distance_km_6</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>149.6
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>And we can get an idea from the above of how spread out the planets are.</p>

<p>The Earth is the third of eight planets, yet its distance from the sun is less than 12% their average.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">earth</span><span class="o">.</span><span class="n">solar_distance_km_6</span> <span class="o">/</span> <span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.11822231880908397
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Generally, we might note that the median distance of planets from the sun is less than half their mean.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">median</span><span class="p">()</span> <span class="o">/</span> <span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.39769640334673473
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p><code class="highlighter-rouge">pandas</code> supports a number of statistical methods, such as standard deviation <code class="highlighter-rouge">std</code>, mean absolute deviation <code class="highlighter-rouge">mad</code>, and more.</p>

<p>We know that the planets are spread out. Let’s take a look at simply how their distances increase.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       NaN
1      50.3
2      41.4
3      78.3
4     550.7
5     654.9
6    1439.0
7    1622.6
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>The above <code class="highlighter-rouge">Series</code> tells us that Venus is 50.3 million kilometers farther from the sun than Mercury, Earth is 41.4 million kilometers farther than Venus, <em>etc.</em> (The first value, for Mercury, is <code class="highlighter-rouge">NaN</code> – “not a number” – because there is no planet closer than it to the sun, with which to compare its distance.)</p>

<p>And, indeed, the distances between the planets increase dramatically.</p>

<p>We can see roughly that the first big jump is in the distance between Mars and Jupiter. The distances between the outer planets then continue to be greater than those between the inner planets, and continue to increase. But there’s another big intermediate jump, between Saturn and Uranus.</p>

<p>We can express the above quantitatively as well:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_rel_change</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">solar_distance_km_6</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>

<span class="n">distance_rel_change</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0         NaN
1    0.868739
2    0.382625
3    0.523396
4    2.416411
5    0.841125
6    1.003837
7    0.564874
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>In preceding examples, we’ve used the built-in operator for division against two numeric arguments of type <code class="highlighter-rouge">float</code>. The result of each of these operations was appropriately also a <code class="highlighter-rouge">float</code>.</p>

<p>We can also apply this operator to divide each of an entire <code class="highlighter-rouge">Series</code> of <code class="highlighter-rouge">float</code> values by a single <code class="highlighter-rouge">float</code>, and in so doing produce a new <code class="highlighter-rouge">Series</code>.</p>

<p>Many built-in operators are supported. For clarity, let’s map our percent-change values to conventional percentages, using the operator for multiplication.</p>

<p>The <code class="highlighter-rouge">pct_change</code> method returns these values as ratios, comparing the distance of each planet from the sun, $distance_1$, to the distance of the planet preceding it, $distance_0$, according to:</p>

<p>\begin{align*}
\frac{distance_1 - distance_0}{distance_0}
\end{align*}</p>

<p>We can represent these as conventional percentages by simply multiplying them by <code class="highlighter-rouge">100</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_pct_change</span> <span class="o">=</span> <span class="n">distance_rel_change</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">distance_pct_change</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0           NaN
1     86.873921
2     38.262477
3     52.339572
4    241.641071
5     84.112510
6    100.383676
7     56.487380
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>And while we all have in mind the order of the planets, it would be more meaningful to see the above values in context, along with our other planetary data.</p>

<p>We can use the <code class="highlighter-rouge">assign</code> method to construct a new <code class="highlighter-rouge">DataFrame</code>, one which begins with the data from <code class="highlighter-rouge">planets</code>, and which adds to this our new column.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">distance_pct_change</span><span class="o">=</span><span class="n">distance_pct_change</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
      <th>distance_pct_change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
      <td>86.873921</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
      <td>38.262477</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
      <td>52.339572</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
      <td>241.641071</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
      <td>84.112510</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
      <td>100.383676</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
      <td>56.487380</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>As you can see, the <code class="highlighter-rouge">assign</code> method accepts <em>only</em> named keyword arguments. Notably, these can be <em>any</em> syntactically-valid name – <code class="highlighter-rouge">pandas</code> adds the sequence of values you specify to the existing data as a new column, and <em>assigns</em> to the new column this name.</p>

<p>Arguably, of course, our multiplication by 100 was only an aesthetic change. We might instead preserve the output of our <code class="highlighter-rouge">pct_change</code> calculation, and merely adjust the presentation of our <code class="highlighter-rouge">DataFrame</code>.</p>

<p><code class="highlighter-rouge">pandas</code> offers the <code class="highlighter-rouge">DataFrame</code> property <code class="highlighter-rouge">style</code>, whose <code class="highlighter-rouge">format</code> method accepts either functions or strings, with which it determines how to present its data. String arguments to this <code class="highlighter-rouge">format</code> method follow Python’s standard form for indicating how a value should be presented as text.</p>

<p>Python’s strings offer their own <code class="highlighter-rouge">format</code> method. And, for example, we might construct a string presenting the <code class="highlighter-rouge">float</code> value <code class="highlighter-rouge">0.868739</code> as a conventional percentage, as follows.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'{:.2</span><span class="si">%</span><span class="s">}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">0.868739</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'86.87%'
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>In a similar manner we can apply this formatting to our column, without altering the underlying values.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_rel_change</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">distance_rel_change</span><span class="o">=</span><span class="n">distance_rel_change</span><span class="p">)</span>

<span class="n">planets_rel_change</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
      <th>distance_rel_change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
      <td>0.868739</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
      <td>0.382625</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
      <td>0.523396</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
      <td>2.416411</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
      <td>0.841125</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
      <td>1.003837</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
      <td>0.564874</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_rel_change</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">({</span>
    <span class="s">'distance_rel_change'</span><span class="p">:</span> <span class="s">'{:.2</span><span class="si">%</span><span class="s">}'</span><span class="p">,</span>
<span class="p">})</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<style type="text/css">
</style><table id="T_e75a3ae8_59a5_11ea_8552_0242ac130003"><thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">name</th>        <th class="col_heading level0 col1">solar_distance_km_6</th>        <th class="col_heading level0 col2">mass_kg_24</th>        <th class="col_heading level0 col3">density_kg_m3</th>        <th class="col_heading level0 col4">gravity_m_s2</th>        <th class="col_heading level0 col5">distance_rel_change</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col0" class="data row0 col0">Mercury</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col1" class="data row0 col1">57.9</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col2" class="data row0 col2">0.33</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col3" class="data row0 col3">5427</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col4" class="data row0 col4">3.7</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row0_col5" class="data row0 col5">nan%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row1" class="row_heading level0 row1">1</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col0" class="data row1 col0">Venus</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col1" class="data row1 col1">108.2</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col2" class="data row1 col2">4.87</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col3" class="data row1 col3">5243</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col4" class="data row1 col4">8.9</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row1_col5" class="data row1 col5">86.87%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row2" class="row_heading level0 row2">2</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col0" class="data row2 col0">Earth</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col1" class="data row2 col1">149.6</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col2" class="data row2 col2">5.97</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col3" class="data row2 col3">5514</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col4" class="data row2 col4">9.8</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row2_col5" class="data row2 col5">38.26%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row3" class="row_heading level0 row3">3</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col0" class="data row3 col0">Mars</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col1" class="data row3 col1">227.9</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col2" class="data row3 col2">0.642</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col3" class="data row3 col3">3933</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col4" class="data row3 col4">3.7</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row3_col5" class="data row3 col5">52.34%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row4" class="row_heading level0 row4">4</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col0" class="data row4 col0">Jupiter</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col1" class="data row4 col1">778.6</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col2" class="data row4 col2">1898</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col3" class="data row4 col3">1326</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col4" class="data row4 col4">23.1</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row4_col5" class="data row4 col5">241.64%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row5" class="row_heading level0 row5">5</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col0" class="data row5 col0">Saturn</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col1" class="data row5 col1">1433.5</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col2" class="data row5 col2">568</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col3" class="data row5 col3">687</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col4" class="data row5 col4">9</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row5_col5" class="data row5 col5">84.11%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row6" class="row_heading level0 row6">6</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col0" class="data row6 col0">Uranus</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col1" class="data row6 col1">2872.5</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col2" class="data row6 col2">86.8</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col3" class="data row6 col3">1271</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col4" class="data row6 col4">8.7</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row6_col5" class="data row6 col5">100.38%</td>
            </tr>
            <tr>
                        <th id="T_e75a3ae8_59a5_11ea_8552_0242ac130003level0_row7" class="row_heading level0 row7">7</th>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col0" class="data row7 col0">Neptune</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col1" class="data row7 col1">4495.1</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col2" class="data row7 col2">102</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col3" class="data row7 col3">1638</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col4" class="data row7 col4">11</td>
                        <td id="T_e75a3ae8_59a5_11ea_8552_0242ac130003row7_col5" class="data row7 col5">56.49%</td>
            </tr>
    </tbody></table>
</div>

    </div>
  </div>
</div>

<p>Note, in the above, we made use of another collection built into Python: the <code class="highlighter-rouge">dict</code>, or “dictionary.” The syntax of <code class="highlighter-rouge">dict</code> construction is simply:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{KEY0: VALUE0, …}
</code></pre></div></div>

<p>Dictionaries are widely useful; but, here, you’ll only see them as another means of associating keyword arguments with their values, analogous to how <code class="highlighter-rouge">assign</code> is called.</p>

<p>We can also rename columns, in this case also for clarity, and again making use of a <code class="highlighter-rouge">dict</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_rel_change</span> <span class="o">=</span> <span class="n">planets_rel_change</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s">'distance_rel_change'</span><span class="p">:</span> <span class="s">'distance relative change'</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">planets_rel_change</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">({</span>
    <span class="s">'distance relative change'</span><span class="p">:</span> <span class="s">'{:.2</span><span class="si">%</span><span class="s">}'</span><span class="p">,</span>
<span class="p">})</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<style type="text/css">
</style><table id="T_e75f984e_59a5_11ea_8552_0242ac130003"><thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">name</th>        <th class="col_heading level0 col1">solar_distance_km_6</th>        <th class="col_heading level0 col2">mass_kg_24</th>        <th class="col_heading level0 col3">density_kg_m3</th>        <th class="col_heading level0 col4">gravity_m_s2</th>        <th class="col_heading level0 col5">distance relative change</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col0" class="data row0 col0">Mercury</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col1" class="data row0 col1">57.9</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col2" class="data row0 col2">0.33</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col3" class="data row0 col3">5427</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col4" class="data row0 col4">3.7</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row0_col5" class="data row0 col5">nan%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row1" class="row_heading level0 row1">1</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col0" class="data row1 col0">Venus</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col1" class="data row1 col1">108.2</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col2" class="data row1 col2">4.87</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col3" class="data row1 col3">5243</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col4" class="data row1 col4">8.9</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row1_col5" class="data row1 col5">86.87%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row2" class="row_heading level0 row2">2</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col0" class="data row2 col0">Earth</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col1" class="data row2 col1">149.6</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col2" class="data row2 col2">5.97</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col3" class="data row2 col3">5514</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col4" class="data row2 col4">9.8</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row2_col5" class="data row2 col5">38.26%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row3" class="row_heading level0 row3">3</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col0" class="data row3 col0">Mars</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col1" class="data row3 col1">227.9</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col2" class="data row3 col2">0.642</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col3" class="data row3 col3">3933</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col4" class="data row3 col4">3.7</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row3_col5" class="data row3 col5">52.34%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row4" class="row_heading level0 row4">4</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col0" class="data row4 col0">Jupiter</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col1" class="data row4 col1">778.6</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col2" class="data row4 col2">1898</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col3" class="data row4 col3">1326</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col4" class="data row4 col4">23.1</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row4_col5" class="data row4 col5">241.64%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row5" class="row_heading level0 row5">5</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col0" class="data row5 col0">Saturn</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col1" class="data row5 col1">1433.5</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col2" class="data row5 col2">568</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col3" class="data row5 col3">687</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col4" class="data row5 col4">9</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row5_col5" class="data row5 col5">84.11%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row6" class="row_heading level0 row6">6</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col0" class="data row6 col0">Uranus</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col1" class="data row6 col1">2872.5</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col2" class="data row6 col2">86.8</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col3" class="data row6 col3">1271</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col4" class="data row6 col4">8.7</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row6_col5" class="data row6 col5">100.38%</td>
            </tr>
            <tr>
                        <th id="T_e75f984e_59a5_11ea_8552_0242ac130003level0_row7" class="row_heading level0 row7">7</th>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col0" class="data row7 col0">Neptune</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col1" class="data row7 col1">4495.1</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col2" class="data row7 col2">102</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col3" class="data row7 col3">1638</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col4" class="data row7 col4">11</td>
                        <td id="T_e75f984e_59a5_11ea_8552_0242ac130003row7_col5" class="data row7 col5">56.49%</td>
            </tr>
    </tbody></table>
</div>

    </div>
  </div>
</div>

<p>Because we’ve added spaces to our column name, it’s no longer valid in the syntax of Python, and so we can no longer refer to it as we have the other columns, such as <code class="highlighter-rouge">solar_distance_km_6</code>:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_rel_change</span><span class="o">.</span><span class="n">solar_distance_km_6</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0      57.9
1     108.2
2     149.6
3     227.9
4     778.6
5    1433.5
6    2872.5
7    4495.1
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>But, we can still refer to it using the alternate syntax mentioned above:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_rel_change</span><span class="p">[</span><span class="s">'distance relative change'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0         NaN
1    0.868739
2    0.382625
3    0.523396
4    2.416411
5    0.841125
6    1.003837
7    0.564874
Name: distance relative change, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<h2 id="selection-by-label">Selection by label</h2>

<p>With <code class="highlighter-rouge">iloc</code>, we were able to slice rows of our data, selecting out individuals, according to their numeric position in the index. We can also select rows <em>and</em> columns, selecting subsets of features, (and much more!), thanks to <code class="highlighter-rouge">loc</code>.</p>

<p>Let’s begin by providing our <code class="highlighter-rouge">DataFrame</code> a more natural row index for the planets. Indexes may be modified after the fact or provided during construction.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">planets_data</span><span class="p">,</span>
                       <span class="n">columns</span><span class="o">=</span><span class="n">planets_features</span><span class="p">,</span>
                       <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'number'</span><span class="p">))</span>

<span class="n">planets</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>With <code class="highlighter-rouge">iloc</code>, we retrieve the third individual from this <code class="highlighter-rouge">DataFrame</code> by specifying the offset <code class="highlighter-rouge">2</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Earth
solar_distance_km_6    149.6
mass_kg_24              5.97
density_kg_m3           5514
gravity_m_s2             9.8
Name: 3, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>But with <code class="highlighter-rouge">loc</code>, we can retrieve this individual – Earth – by its index value or row label – now <code class="highlighter-rouge">3</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Earth
solar_distance_km_6    149.6
mass_kg_24              5.97
density_kg_m3           5514
gravity_m_s2             9.8
Name: 3, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>While numeric indexes are often more practical, we can further distinguish these individuals’ labels in the row index by using familiar strings instead.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ordinals</span> <span class="o">=</span> <span class="p">[</span><span class="s">'first'</span><span class="p">,</span> <span class="s">'second'</span><span class="p">,</span> <span class="s">'third'</span><span class="p">,</span> <span class="s">'fourth'</span><span class="p">,</span> <span class="s">'fifth'</span><span class="p">,</span> <span class="s">'sixth'</span><span class="p">,</span> <span class="s">'seventh'</span><span class="p">,</span> <span class="s">'eighth'</span><span class="p">]</span>

<span class="n">planet_ordinals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">planets_data</span><span class="p">,</span>
                               <span class="n">columns</span><span class="o">=</span><span class="n">planets_features</span><span class="p">,</span>
                               <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">ordinals</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'ordinal'</span><span class="p">))</span>

<span class="n">planet_ordinals</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>ordinal</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>first</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>second</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>third</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>fourth</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>fifth</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>sixth</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>seventh</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>eighth</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p><code class="highlighter-rouge">loc</code> supports the same selection features as <code class="highlighter-rouge">iloc</code>, such as slicing, even as it considers labels rather than offsets.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">middle_planets</span> <span class="o">=</span> <span class="n">planet_ordinals</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'third'</span><span class="p">:</span><span class="s">'sixth'</span><span class="p">]</span>

<span class="n">middle_planets</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>ordinal</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>third</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>fourth</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>fifth</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>sixth</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p><strong>But watch out!</strong> In the above example, <code class="highlighter-rouge">loc</code> interpreted our slice differently than <code class="highlighter-rouge">iloc</code> – <em>both</em> the elements at the slice <code class="highlighter-rouge">start</code> and <code class="highlighter-rouge">stop</code> were included in the results. This is convenient, because labels aren’t necessarily incremental; we may not have in mind the label <em>following</em> the last one we want. Nonetheless, this is an inconsistency.</p>

<p>That said, <code class="highlighter-rouge">loc</code> resolves the inconsistency of the reference used in selecting out individuals from slices of the original <code class="highlighter-rouge">DataFrame</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">middle_planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Earth
solar_distance_km_6    149.6
mass_kg_24              5.97
density_kg_m3           5514
gravity_m_s2             9.8
Name: third, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Using <code class="highlighter-rouge">iloc</code> we must refer to Earth as the “zeroeth” (zero-offset or “first”) in the above data subset named <code class="highlighter-rouge">middle_planets</code>…</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">middle_planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'third'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Earth
solar_distance_km_6    149.6
mass_kg_24              5.97
density_kg_m3           5514
gravity_m_s2             9.8
Name: third, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>…but using <code class="highlighter-rouge">loc</code>, we may continue to refer to Earth as the “third” planet from the sun.</p>

<p>In addition to selecting out individuals by row label, <code class="highlighter-rouge">loc</code> also allows us to select features by column label.</p>

<p>Say we wanted to contextualize <code class="highlighter-rouge">distance_pct_change</code>, reproducing that <code class="highlighter-rouge">DataFrame</code>, but this time with only the most-relevant columns, <code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">solar_distance_km_6</code>. Bear in mind that there are many ways about this! But the <code class="highlighter-rouge">assign</code> method, at least, enables us to create a new <code class="highlighter-rouge">DataFrame</code> from an existing one; while, our existing <code class="highlighter-rouge">DataFrame</code> of the planets contains the “offending” columns. To start, we want a <code class="highlighter-rouge">DataFrame</code> containing only those two columns.</p>

<p>When we’ve focused on singular features before, such as the <code class="highlighter-rouge">name</code> data, it hasn’t been a <code class="highlighter-rouge">DataFrame</code> – it’s a <code class="highlighter-rouge">Series</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">name</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    Mercury
2      Venus
3      Earth
4       Mars
5    Jupiter
6     Saturn
7     Uranus
8    Neptune
Name: name, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span><span class="p">(</span><span class="n">planets</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandas.core.series.Series
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">distance_pct_change</span><span class="o">=</span><span class="n">distance_pct_change</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_traceback_line highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    &lt;ipython-input-41-6e505a852e2e&gt; in &lt;module&gt;
    ----&gt; 1 planets.name.assign(distance_pct_change=distance_pct_change)
    

    /opt/conda/lib/python3.7/site-packages/pandas/core/generic.py in __getattr__(self, name)
       5177             if self._info_axis._can_hold_identifiers_and_holds_name(name):
       5178                 return self[name]
    -&gt; 5179             return object.__getattribute__(self, name)
       5180 
       5181     def __setattr__(self, name, value):


    AttributeError: 'Series' object has no attribute 'assign'


</code></pre></div>      </div>
    </div>
  </div>
</div>

<p>Well, <em>that</em> didn’t work….</p>

<p>Instead, let’s use <code class="highlighter-rouge">loc</code> to slice our <code class="highlighter-rouge">DataFrame</code> along its columns – and create a <code class="highlighter-rouge">DataFrame</code> with only the features we want.</p>

<p>Unlike what we’ve seen so far, element retrieval from the <code class="highlighter-rouge">loc</code> property can accept multiple arguments.</p>

<ol>
  <li>The first argument indicates row(s) to select – as above, by label, rather than offset.</li>
  <li>The second argument does the same, but for column(s).</li>
</ol>

<p>Because these arguments are positional, we can’t provide the second argument without also providing the first. Luckily, we needn’t supply arguments to the slice itself, so indicating that a new sequence should be constructed from the same elements. With <code class="highlighter-rouge">loc</code> that looks like:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">:]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Further, we can supply just a column label. If our row slice is empty, then this is yet another way to retrieve the complete <code class="highlighter-rouge">Series</code> of data for this feature:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s">'name'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    Mercury
2      Venus
3      Earth
4       Mars
5    Jupiter
6     Saturn
7     Uranus
8    Neptune
Name: name, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>More relevant, we can suply a <code class="highlighter-rouge">list</code> of the features to select.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s">'name'</span><span class="p">]]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>And now we know how to produce the two-feature <code class="highlighter-rouge">DataFrame</code> we were looking for.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planet_distances</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'solar_distance_km_6'</span><span class="p">]]</span>

<span class="n">planet_distances</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">distance_pct_change</span><span class="o">=</span><span class="n">distance_pct_change</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>distance_pct_change</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>86.873921</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>38.262477</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>52.339572</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>241.641071</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>84.112510</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>100.383676</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>56.487380</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p><strong>But that’s not right!</strong> Let’s take another look at <code class="highlighter-rouge">distance_pct_change</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_pct_change</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0           NaN
1     86.873921
2     38.262477
3     52.339572
4    241.641071
5     84.112510
6    100.383676
7     56.487380
Name: solar_distance_km_6, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Indeed, we’ve changed the index of our <code class="highlighter-rouge">DataFrame</code> – now it’s 1 through 8, rather than the 0 through 7 of <code class="highlighter-rouge">distance_pct_change</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_pct_change</span><span class="o">.</span><span class="n">index</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RangeIndex(start=0, stop=8, step=1)
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Luckily, there’s more than one resolution. Let’s tell the index of <code class="highlighter-rouge">distance_pct_change</code> to increase all of its values by <code class="highlighter-rouge">1</code>, using the <code class="highlighter-rouge">+=</code> operator.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_pct_change</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

</code></pre></div>    </div>
  </div>

</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">distance_pct_change</span><span class="o">.</span><span class="n">index</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RangeIndex(start=1, stop=9, step=1)
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Now we’re set.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planet_distances</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">distance_pct_change</span><span class="o">=</span><span class="n">distance_pct_change</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>distance_pct_change</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>86.873921</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>38.262477</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>52.339572</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>241.641071</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>84.112510</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>100.383676</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>56.487380</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>In fact, <code class="highlighter-rouge">pandas</code> often offers more than one way to achieve the same, or a similar, result. We can also select rows and columns – in this case less succinctly – by specifying what labeled elements we <em>don’t</em> want, using <code class="highlighter-rouge">drop</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'mass_kg_24'</span><span class="p">,</span> <span class="s">'density_kg_m3'</span><span class="p">,</span> <span class="s">'gravity_m_s2'</span><span class="p">])</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<h2 id="selection-by-condition">Selection by condition</h2>

<p>So far we’ve selected individuals based on their position in the row index and based on their row index value or label. But particularly in larger data sets, this may not be practical.</p>

<p>To begin, we might sort our data by a column or a set of columns. Say we were having trouble finding Earth – we could produce a new <code class="highlighter-rouge">DataFrame</code>, sorted by the <code class="highlighter-rouge">name</code> feature.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>By default, this sorts individuals in “ascending” order – from alphabetical “first” to “last” and numerical smallest to greatest.</p>

<p>If instead we wanted to see the most massive planets, we would sort by the <code class="highlighter-rouge">mass_kg_24</code> feature, but in “descending” order.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_massive</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'mass_kg_24'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">planets_massive</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.000</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.000</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.000</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.800</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.970</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.870</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Mars</td>
      <td>227.9</td>
      <td>0.642</td>
      <td>3933.0</td>
      <td>3.7</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Mercury</td>
      <td>57.9</td>
      <td>0.330</td>
      <td>5427.0</td>
      <td>3.7</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>In both cases, we are interested in the first-listed rows. For example, we can extract the most massive planet, Jupiter, from the sorted <code class="highlighter-rouge">DataFrame</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets_massive</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name                   Jupiter
solar_distance_km_6      778.6
mass_kg_24                1898
density_kg_m3             1326
gravity_m_s2              23.1
Name: 5, dtype: object
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Sorting in this way can get you pretty far. But more powerfully, you can specify a <em>condition</em> or a set of conditions which individuals must pass in order to be selected.</p>

<p>Again, the <code class="highlighter-rouge">DataFrame</code> property <code class="highlighter-rouge">loc</code> does the job for us. It supports the output of a <code class="highlighter-rouge">DataFrame</code> with the same features as the original but only the individuals whose features satisfy the condition.</p>

<p>Rather than using an offset, label or slice, this is specified to <code class="highlighter-rouge">loc</code> using a <em>boolean</em> sequence, which itself indicates the rows satisfying our condition, such as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[True, False, True]
</code></pre></div></div>

<p>But don’t worry! We needn’t produce this <code class="highlighter-rouge">list</code> ourselves. We can generate it from a simple conditional expression in Python, applied to the <code class="highlighter-rouge">Series</code> of data underlying the feature itself.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">mass_kg_24</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1       0.330
2       4.870
3       5.970
4       0.642
5    1898.000
6     568.000
7      86.800
8     102.000
Name: mass_kg_24, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Our solar system’s inner planets never get any more massive than Earth – less than 6 x 10<sup>24</sup> kilograms in mass. We can exclude such lightweights with the <em>mask</em> produced by the following comparison expression.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">mass_kg_24</span> <span class="o">&gt;</span> <span class="mi">6</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    False
2    False
3    False
4    False
5     True
6     True
7     True
8     True
Name: mass_kg_24, dtype: bool
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>As you can see, we’ve produced a new <code class="highlighter-rouge">Series</code>, populated by Boolean values which reflect that the “statement” of our comparison – that the planets’ masses are “greater than 6” thousand yottagrams – is <code class="highlighter-rouge">False</code> for the first four planets, but <code class="highlighter-rouge">True</code> for the remainder.</p>

<p>We can specify to <code class="highlighter-rouge">loc</code> this mask – if we like, of course, the expression itself – and produce our new <code class="highlighter-rouge">DataFrame</code> of individuals satisfying our condition.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">planets</span><span class="o">.</span><span class="n">mass_kg_24</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.0</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.0</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.8</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.0</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Or, even simpler, we can construct the same sort of look-up to find Earth.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">planets</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">'Earth'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Above we built our conditions from a known value, such as <code class="highlighter-rouge">6</code>. We can build a value look-up into our comparison as well.</p>

<p>Another look-up property, <code class="highlighter-rouge">at</code>, provides a shortcut to scalar values.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'mass_kg_24'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5.97
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">planets</span><span class="o">.</span><span class="n">mass_kg_24</span> <span class="o">&gt;</span> <span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'mass_kg_24'</span><span class="p">]</span>
<span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>Jupiter</td>
      <td>778.6</td>
      <td>1898.0</td>
      <td>1326.0</td>
      <td>23.1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.0</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.8</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.0</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>We can also select individuals that satisfy multiple conditions.</p>

<p>Let’s compare the planets of our solar system to the Earth. We can begin by selecting only those planets whose gravity is within approximately 50% of Earth’s – less than $14.8\frac{m}{s^2}$ and more than $4.8\frac{m}{s^2}$.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">not_too_much_gravity</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">gravity_m_s2</span> <span class="o">&lt;</span> <span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'gravity_m_s2'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span>

<span class="n">not_too_much_gravity</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1     True
2     True
3     True
4     True
5    False
6     True
7     True
8     True
Name: gravity_m_s2, dtype: bool
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">not_too_little_gravity</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">gravity_m_s2</span> <span class="o">&gt;</span> <span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'gravity_m_s2'</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span>

<span class="n">not_too_little_gravity</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    False
2     True
3     True
4    False
5     True
6     True
7     True
8     True
Name: gravity_m_s2, dtype: bool
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>We might simply invoke <code class="highlighter-rouge">loc</code> twice, once for each condition.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">not_too_much_gravity</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">not_too_little_gravity</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.87</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.00</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.80</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.00</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Or, more powerfully, we can combine our conditions into a single conditional mask. In this case, we want <em>both</em> conditions to be satisfied, and so we’ll combine them using the <em>bitwise AND</em> operator: <code class="highlighter-rouge">&amp;</code>.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">not_too_much_gravity</span> <span class="o">&amp;</span> <span class="n">not_too_little_gravity</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    False
2     True
3     True
4    False
5    False
6     True
7     True
8     True
Name: gravity_m_s2, dtype: bool
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">not_too_much_gravity</span> <span class="o">&amp;</span> <span class="n">not_too_little_gravity</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.87</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Saturn</td>
      <td>1433.5</td>
      <td>568.00</td>
      <td>687.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Uranus</td>
      <td>2872.5</td>
      <td>86.80</td>
      <td>1271.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Neptune</td>
      <td>4495.1</td>
      <td>102.00</td>
      <td>1638.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>We’re left with the majority of the planets. Only Mercury, Mars and Jupiter have been excluded – Mercury and Mars for having too little gravity, and Jupiter for having too much.</p>

<p>In fact, we know that Saturn is a gas giant, consisting almost entirely of hydrogen gas – nothing at all like Earth! This fact is indirectly evident from its density: less than 13% of the density of the Earth.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">density_kg_m3</span> <span class="o">/</span> <span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'density_kg_m3'</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1    0.984222
2    0.950852
3    1.000000
4    0.713275
5    0.240479
6    0.124592
7    0.230504
8    0.297062
Name: density_kg_m3, dtype: float64
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>We can exclude the gas giants as well by combining our gravity-based conditions with a density-based condition: that the planets’ densities are at least 50% of Earth’s.</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dense_enough</span> <span class="o">=</span> <span class="n">planets</span><span class="o">.</span><span class="n">density_kg_m3</span> <span class="o">&gt;=</span> <span class="n">planets</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'density_kg_m3'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.5</span>

<span class="n">dense_enough</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>number
1     True
2     True
3     True
4     True
5    False
6    False
7    False
8    False
Name: density_kg_m3, dtype: bool
</code></pre></div>      </div>

    </div>
  </div>
</div>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">not_too_much_gravity</span> <span class="o">&amp;</span> <span class="n">not_too_little_gravity</span> <span class="o">&amp;</span> <span class="n">dense_enough</span><span class="p">]</span>

</code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>solar_distance_km_6</th>
      <th>mass_kg_24</th>
      <th>density_kg_m3</th>
      <th>gravity_m_s2</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>Venus</td>
      <td>108.2</td>
      <td>4.87</td>
      <td>5243.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Earth</td>
      <td>149.6</td>
      <td>5.97</td>
      <td>5514.0</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

    </div>
  </div>
</div>

<p>Now we’re left with only Venus and Earth.</p>

<p>And, we’re given an excellent example of the danger of drawing conclusions from too-small a data set. The two planets appear similar, judging by the above. Venus <em>is</em> considerably closer to the sun – 41.4 million kilometers closer than the Earth; but, as we saw, this is the <em>smallest</em> distance between any of the planets, and it’s difficult to gauge the significance of this feature with regard to its similarity to Earth … at least, this feature on its own.</p>

<p>That said, if our data included a feature like <code class="highlighter-rouge">average_temperature_celsius</code> – for which Venus would be 462° – then we’d know why Mars is considered the most likely habitable planet in our solar system, outside of the Earth … never mind <em>its</em> average temperature of -63° Celsius, and its much lower gravity!</p>

<p>In conclusion, <code class="highlighter-rouge">pandas</code> and its <code class="highlighter-rouge">DataFrame</code> offer a great many additions to the data structures, functions and methods of Python, in support of processing and analyzing data. This introduction only covers some of the basic ways in which <code class="highlighter-rouge">pandas</code> builds upon and differs from what we’ve seen so far. But don’t be overwhelmed! The best way to learn is to dive in. Apply what you’ve learned here, consult the <a href="https://pandas.pydata.org/docs/" target="_blank" rel="noopener">pandas documentation</a> (and the <a href="https://en.wikipedia.org/wiki/Internet" target="_blank" rel="noopener">Internet</a>) … and read on!</p>


              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/03/6/Functions.html">
      〈 <span class="u-margin-right-tiny"></span> Functions
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="">
       <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
